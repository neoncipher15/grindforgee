<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GrindForge</title>
<link rel="icon" type="image/png" href="/GrindForge.png">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0b0f17;
  --panel:#0f172a;
  --panel-soft:#020617;
  --border:rgba(255,255,255,.08);
  --text:#e5e7eb;
  --muted:#9ca3af;
  --accent:#2f81f7;
  --radius:16px;
}

*{margin:0;padding:0;box-sizing:border-box}

body{
  font-family:Inter,system-ui,sans-serif;
  background:radial-gradient(1200px 600px at 50% -10%,#111827,#020617 70%);
  color:var(--text);
  min-height:100vh;
}

/* ================= HEADER ================= */
.header{
  position:sticky;
  top:0;
  z-index:10;
  backdrop-filter:blur(16px);
  background:rgba(11,15,23,.9);
  border-bottom:1px solid var(--border);
}
.header-content{
  max-width:1200px;
  margin:auto;
  padding:16px 24px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.brand{
  display:flex;
  align-items:center;
  gap:12px;
}
.brand-logo{
  width:34px;
  height:34px;
  object-fit:contain;
  border-radius:6px;
}
.brand-title{font-weight:800;font-size:1.3rem}
.header-stats{display:flex;gap:12px}
.stat-pill{
  padding:8px 14px;
  border-radius:999px;
  background:var(--panel);
  border:1px solid var(--border);
  font-size:.85rem;
  color:var(--muted);
}

/* ================= DASHBOARD ================= */
.dashboard{
  max-width:1200px;
  margin:auto;
  padding:32px 24px;
  display:grid;
  grid-template-columns:1fr 380px;
  gap:32px;
}
@media(max-width:1000px){.dashboard{grid-template-columns:1fr}}

/* ================= TIMER ================= */
.hero-timer{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:28px;
}
.timer-mega{
  width:300px;
  height:300px;
  border-radius:50%;
  background:conic-gradient(var(--accent) var(--progress,0deg),#1f2937 0deg);
  display:flex;
  align-items:center;
  justify-content:center;
}
.timer-inner{
  width:240px;
  height:240px;
  border-radius:50%;
  background:var(--panel);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}
.timer-display{font-size:3.5rem;font-weight:800}
.phase-badge{
  margin-top:6px;
  font-size:.8rem;
  letter-spacing:.2em;
  color:var(--muted);
}

/* ================= BUTTONS ================= */
.timer-controls{display:flex;gap:12px;flex-wrap:wrap}
.btn{
  padding:12px 22px;
  border-radius:14px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  font-weight:600;
  cursor:pointer;
}
.btn-primary{
  background:linear-gradient(135deg,#1f6feb,#2f81f7);
  border:none;
  color:#fff;
  box-shadow:0 8px 24px rgba(47,129,247,.45);
}

/* ================= SIDEBAR ================= */
.sidebar{display:flex;flex-direction:column;gap:24px}
.panel{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:24px;
}
.panel-title{font-weight:700;margin-bottom:16px}

/* ================= STATS ================= */
.stats-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.stat-card{
  background:var(--panel-soft);
  border:1px solid var(--border);
  border-radius:12px;
  padding:16px;
  text-align:center;
}
.stat-value{font-size:1.7rem;font-weight:800}
.stat-label{
  font-size:.7rem;
  color:var(--muted);
  letter-spacing:.1em;
  text-transform:uppercase;
}

/* ================= LOCK IN MODE ================= */
.lock-in{
  position:fixed;
  inset:0;
  background:rgba(2,6,23,.95);
  backdrop-filter:blur(10px);
  z-index:999;
  display:none;
  justify-content:center;
  align-items:center;
}
.lock-in.active{display:flex}

.lock-in .hero-timer{
  position:absolute;
  inset:0;
  justify-content:center;
  z-index:1;

} 
.lock-in .timer-mega{
  width:70vmin;
  height:70vmin;
}
.lock-in .timer-inner{
  width:55vmin;
  height:55vmin;
}
.lock-in .timer-display{font-size:6rem} 

/* ================= QUICK SETTINGS (PREMIUM) ================= */
.quick-settings-btn{
  position:absolute;
  bottom:24px;
  left:24px;
  z-index:1002;
}
.settings-modal{
  position:absolute;
  bottom:96px; /* raised so it sits above the button with some gap */
  left:24px;
  background:rgba(15,23,42,.9);
  backdrop-filter:blur(14px);
  border:1px solid var(--border);
  border-radius:18px;
  padding:20px;
  display:none;
  width:260px;
  z-index:1002;
}
.settings-modal.show{display:block} 
.settings-modal label{
  font-size:.75rem;
  color:var(--muted);
}
.settings-modal input{
  width:100%;
  margin:6px 0 14px;
  padding:8px 10px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--panel-soft);
  color:var(--text);
  -moz-appearance:textfield; /* remove spinner on Firefox */
}
/* remove number input spinners on WebKit browsers within quick settings */
.settings-modal input[type=number]::-webkit-outer-spin-button,
.settings-modal input[type=number]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
/* task entry layout & placeholder design */
.task-entry{
  display:flex;
  gap:8px;
  margin-bottom:12px;
  align-items:flex-start;
}
.task-input-wrap{ position:relative; flex:1; }
.task-input{
  width:100%;
  padding:10px 10px 10px 40px; /* space for icon */
  border-radius:8px;
  border:1px solid var(--border);
  background:var(--panel-soft);
  color:var(--text);
  font-weight:500;
}
/* inline pencil icon (SVG data URI) */
.task-input{
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23A6B0B9' stroke-width='1.8' stroke-linecap='round' stroke-linejoin='round'><path d='M12 20h9'/><path d='M16.5 3.5L20.5 7.5 7 21l-4 1 1-4L16.5 3.5z'/></svg>");
  background-repeat:no-repeat;
  background-position:12px center;
  background-size:18px 18px;
}
.task-entry .task-input::placeholder{
  color:rgba(166,176,185,0.95);
  font-style:normal;
  font-weight:500;
  opacity:1;
}
.task-placeholder-helper{
  position:absolute;
  left:40px;
  top:44px;
  font-size:.75rem;
  color:var(--muted);
}
.task-placeholder-helper code{ background:rgba(255,255,255,0.03); padding:2px 6px; border-radius:6px; font-family:monospace; color:var(--text); }
 

/* ================= LOCK IN EXIT ================= */
.exit-lock{
  position:absolute;
  top:24px;
  right:24px;
  z-index:1003;
} 
</style>
</head>

<body>

<header class="header">
  <div class="header-content">
    <div class="brand">
      <img src="./GrindForge.png" alt="GrindForge" class="brand-logo">
      <div class="brand-title">GrindForge</div>
    </div>
    <div class="header-stats">
      <div class="stat-pill"><span id="headerPomodoros">0</span> Today</div>
      <div class="stat-pill">Streak: <span id="headerStreak">0</span></div>
    </div>
  </div>
</header>

<main class="dashboard">
<section class="hero-timer" id="timerSection">
  <div class="timer-mega" id="timerMega">
    <div class="timer-inner">
      <div class="timer-display" id="timerDisplay">25:00</div>
      <div class="phase-badge" id="phaseBadge">WORK</div>
    </div>
  </div>
  <div class="timer-controls">
    <button class="btn btn-primary" id="startBtn">Start</button>
    <button class="btn" id="pauseBtn">Pause</button>
    <button class="btn" id="resetBtn">Reset</button>
    <button class="btn" id="lockBtn">LOCK IN</button>
  </div>
</section>

<aside class="sidebar">
  <div class="panel">
    <h3 class="panel-title">üìä Grind Stats</h3>
    <div class="stats-grid">
      <div class="stat-card"><div class="stat-value" id="totalPomodoros">0</div><div class="stat-label">Pomodoros</div></div>
      <div class="stat-card"><div class="stat-value" id="currentStreak">0</div><div class="stat-label">Streak</div></div>
      <div class="stat-card"><div class="stat-value" id="todayTasksDone">0</div><div class="stat-label">Tasks today</div></div>
      <div class="stat-card"><div class="stat-value" id="todayTime">0h 0m</div><div class="stat-label">Time today</div></div>
    </div>
  </div>

  <div class="panel">
    <h3 class="panel-title">üìù Tasks</h3>
    <div class="task-entry">
      <div class="task-input-wrap">
        <input id="taskInput" class="task-input" placeholder="e.g. Plan feature ‚Äî 25m" />
         </div>
      <button class="btn" id="addTaskBtn">Add</button>
    </div>
    <div id="tasksList" class="tasks-list"></div>
  </div>

 
</aside>
</main>

<!-- LOCK IN OVERLAY -->
<div class="lock-in" id="lockin">
  <button class="btn exit-lock" id="exitLock">EXIT</button>

  <div class="hero-timer"></div>

  <div class="quick-settings-btn">
    <button class="btn" id="quickSettingsBtn">‚öô QUICK SETTINGS</button>
  </div>

  <div class="settings-modal" id="settingsModal">
    <label>Work</label><input id="workTime" type="number" value="25">
    <label>Short Break</label><input id="shortBreak" type="number" value="5">
    <label>Long Break</label><input id="longBreak" type="number" value="15">
    <div class="settings-actions" style="display:flex;gap:8px;margin-top:8px;">
      <button class="btn" id="saveSettingsBtn">Save</button>
      <button class="btn" id="closeSettingsBtn">Close</button>
    </div>
  </div>
  <div id="popupTasks" class="task-popup"></div>
</div>

<script>
let timer=null,secondsLeft=1500,totalSeconds=1500;
const display=document.getElementById("timerDisplay");
const mega=document.getElementById("timerMega");
const lockin=document.getElementById("lockin");
const timerSection=document.getElementById("timerSection");
const startBtn = document.getElementById("startBtn");
const pauseBtn = document.getElementById("pauseBtn");
const resetBtn = document.getElementById("resetBtn");
const lockBtn = document.getElementById("lockBtn");
const exitLock = document.getElementById("exitLock");
const quickSettingsBtn = document.getElementById("quickSettingsBtn");

function format(s){return Math.floor(s/60)+":"+String(s%60).padStart(2,"0")}
function update(){
  display.textContent=format(secondsLeft);
  mega.style.setProperty("--progress",(360*(1-secondsLeft/totalSeconds))+"deg");
}
function start(){
  if(timer)return;
  timer=setInterval(()=>{
    secondsLeft--;update();
    if(secondsLeft<=0){clearInterval(timer);timer=null;}
  },1000);
}
function pause(){clearInterval(timer);timer=null}
function doReset(){pause();secondsLeft=totalSeconds;update()} 

startBtn.addEventListener('click', start);
pauseBtn.addEventListener('click', pause);
resetBtn.addEventListener('click', doReset);
if(quickSettingsBtn) quickSettingsBtn.addEventListener('click', toggleSettings);

lockBtn.onclick = ()=>{
  // show lock overlay and move timer into it
  if(!lockin.classList.contains('active')){
    lockin.classList.add('active');
    const hero = lockin.querySelector('.hero-timer');
    if(hero && timerSection && !hero.contains(timerSection)) hero.appendChild(timerSection);
  }
};
exitLock.onclick = ()=>{
  // hide overlay and move timer back if needed
  if(lockin.classList.contains('active')){
    lockin.classList.remove('active');
    const dashboard = document.querySelector('.dashboard');
    if(dashboard && timerSection && !dashboard.contains(timerSection)) dashboard.prepend(timerSection);
  }
};

function toggleSettings(){
  document.getElementById("settingsModal").classList.toggle("show");
}

// ===== SETTINGS persistence & handlers =====
const workInput = document.getElementById('workTime');
const shortInput = document.getElementById('shortBreak');
const longInput = document.getElementById('longBreak');
const saveSettingsBtn = document.getElementById('saveSettingsBtn');
const closeSettingsBtn = document.getElementById('closeSettingsBtn');

function applySettingsToTimer(){
  const w = Number(workInput?.value) || 25;
  totalSeconds = w*60;
  secondsLeft = totalSeconds;
  update();
}

if(saveSettingsBtn){
  saveSettingsBtn.addEventListener('click', ()=>{
    const w = Number(workInput.value) || 25;
    const s = Number(shortInput.value) || 5;
    const l = Number(longInput.value) || 15;
    localStorage.setItem('pf_work', w);
    localStorage.setItem('pf_short', s);
    localStorage.setItem('pf_long', l);
    applySettingsToTimer();
    toggleSettings();
  });
}
if(closeSettingsBtn) closeSettingsBtn.addEventListener('click', toggleSettings);

// populate inputs from storage
const savedWork = Number(localStorage.getItem('pf_work'));
if(savedWork) workInput.value = savedWork;
const savedShort = Number(localStorage.getItem('pf_short'));
if(savedShort) shortInput.value = savedShort;
const savedLong = Number(localStorage.getItem('pf_long'));
if(savedLong) longInput.value = savedLong;

// ===== TASKS (structured local implementation) =====
const tasksListEl = document.getElementById('tasksList');
const popupTasks = document.getElementById('popupTasks');
const taskInput = document.getElementById('taskInput');
const addTaskBtn = document.getElementById('addTaskBtn');
let tasks = JSON.parse(localStorage.getItem('tasks')||'[]'); // items are {text, minutes, createdAt}
let completedTasks = JSON.parse(localStorage.getItem('completedTasks')||'[]');

function escapeHtml(str){ return String(str).replace(/[&<>"']/g, s=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[s])); }
function parseTaskInput(input){
  const m = String(input).trim().match(/^(.*?)\s*(?:[‚Äî‚Äì-]\s*)?(\d+)?\s*m?\s*$/i);
  if(!m) return { text: String(input).trim(), minutes: 0 };
  const minutes = m[2] ? parseInt(m[2],10) : 0;
  const text = (m[1]||'').trim() || input.trim();
  return { text, minutes };
}

function renderTasks(){
  tasksListEl.innerHTML = '';
  popupTasks.innerHTML = '';
  tasks.forEach((t, i)=>{
    const d = document.createElement('div');
    d.className = 'task-item';
    const mins = t.minutes ? `<span class=\"task-min\"> ‚Ä¢ ${t.minutes}m</span>` : '';
    d.innerHTML = `<span>${escapeHtml(t.text)}</span>${mins} <button class=\"task-remove\" data-i=\"${i}\" aria-label=\"Remove task\">√ó</button>`; 
    tasksListEl.appendChild(d);
    const p = d.cloneNode(true);
    popupTasks.appendChild(p);
  });
  renderDailyStats();
}

function addTaskText(raw){
  const parsed = parseTaskInput(raw);
  tasks.push({ text: parsed.text, minutes: parsed.minutes, createdAt: Date.now() });
  localStorage.setItem('tasks', JSON.stringify(tasks));
  renderTasks();
}

addTaskBtn.onclick = ()=>{
  const v = taskInput.value.trim();
  if(!v) return;
  addTaskText(v);
  taskInput.value = '';
};

// allow Enter to add tasks
if(taskInput) taskInput.addEventListener('keydown', e=>{ if(e.key==="Enter") addTaskBtn.click(); });

function markDone(idx){
  const t = tasks[idx];
  if(!t) return;
  const completed = { ...t, completedAt: Date.now() };
  completedTasks.push(completed);
  localStorage.setItem('completedTasks', JSON.stringify(completedTasks));
  tasks.splice(idx,1);
  localStorage.setItem('tasks', JSON.stringify(tasks));
  renderTasks();
}

// delegate done
popupTasks.addEventListener('click', e=>{
  const btn = e.target.closest('button[data-i]');
  if(!btn) return;
  const idx = Number(btn.dataset.i);
  markDone(idx);
});

tasksListEl.addEventListener('click', e=>{
  const btn = e.target.closest('button[data-i]');
  if(!btn) return;
  const idx = Number(btn.dataset.i);
  markDone(idx);
});

function renderDailyStats(){
  const today = new Date().toISOString().slice(0,10);
  let done = 0, minutes = 0;
  (completedTasks||[]).forEach(c=>{
    const d = new Date(c.completedAt).toISOString().slice(0,10);
    if(d===today){ done++; minutes += (c.minutes||0); }
  });
  const tasksEl = document.getElementById('todayTasksDone');
  const timeEl = document.getElementById('todayTime');
  if(tasksEl) tasksEl.textContent = done;
  if(timeEl) timeEl.textContent = `${Math.floor(minutes/60)}h ${minutes%60}m`;
}

renderTasks();

update();
</script>

</body>
</html> 
