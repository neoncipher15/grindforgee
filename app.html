<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GrindForge â€” Pomodoro</title>
<link rel="icon" type="image/png" href="/GrindForge.png" />
<style>
:root{
  --accent:#4ecdc4;
  --bg:#030612;
  --card: rgba(4,6,10,0.85);
  --glass: rgba(0,0,0,0.55);
  --muted:#9adbd4;
  --text:#dffcff;
  --danger:#ff5a5a;
  --success:#6ef0c9;
  --shadow: rgba(2,6,10,0.6);
  --radius:14px;
  --gap:16px;
}
*{box-sizing:border-box}
html,body{height:100%; margin:0}
body{
  font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color:var(--text);
  background-image: url('img.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  overflow-x:hidden;
  -webkit-tap-highlight-color: transparent;
  position: relative;
}

/* Dark overlay */
.overlay{
  position:fixed;
  inset:0;
  background: rgba(0,0,0,0.7);
  z-index: -1;
}

/* EXCEL DASHBOARD LAYOUT - CSS GRID */
.dashboard-grid {
  display: grid;
  height: 100vh;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: auto 1fr 1fr;
  grid-template-areas: 
    "header header"
    "sidebar timer"
    "sidebar todo";
  gap: var(--gap);
  padding: var(--gap);
  box-sizing: border-box;
  max-width: 1400px;
  margin: 0 auto;
}

/* HEADER - Website Name + Logo */
.header {
  grid-area: header;
  display: flex;
  align-items: center;
  gap: 16px;
  background: var(--card);
  backdrop-filter: blur(16px);
  border-radius: var(--radius);
  padding: 20px 28px;
  box-shadow: 0 16px 40px var(--shadow);
  border: 1px solid rgba(78,205,196,0.15);
  position: relative;
  overflow: hidden;
}
.header::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(78,205,196,0.1), transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
}
.header:hover::before { opacity: 1; }
.header:hover { transform: translateY(-2px); }

.logo {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(78,205,196,0.4);
}
.brand-title {
  font-size: 28px;
  font-weight: 800;
  background: linear-gradient(135deg, var(--accent), #6ef0c9);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin: 0;
  letter-spacing: -0.5px;
}
.brand-subtitle {
  font-size: 14px;
  color: var(--muted);
  margin: 0;
  font-weight: 400;
}

/* SIDEBAR - Left column (Date, Quotes, Journal) */
.sidebar {
  grid-area: sidebar;
  display: flex;
  flex-direction: column;
  gap: var(--gap);
  height: 100%;
}

.box{
  background:var(--card);
  backdrop-filter: blur(16px);
  padding:18px;
  border-radius:var(--radius);
  box-shadow: 0 16px 40px var(--shadow);
  transition: all 0.2s ease-out;
  border: 1px solid rgba(78,205,196,0.1);
  flex: 1;
  display: flex;
  flex-direction: column;
}
.box:hover{
  transform: translateY(-4px);
  box-shadow: 0 24px 50px rgba(78,205,196,0.25);
  background: rgba(10,16,30,0.95);
}

/* TIMER - Top Right */
.timer-box{
  grid-area: timer;
  text-align:center;
  background:var(--card);
  backdrop-filter: blur(20px);
  border-radius:var(--radius);
  box-shadow:0 20px 50px var(--shadow);
  border: 1px solid rgba(78,205,196,0.15);
  padding:28px 24px;
  transition: all 0.2s ease-out;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
.timer-box:hover{
  transform:translateY(-4px);
  box-shadow:0 32px 70px rgba(78,205,196,0.3);
}
.timer-box h1{ margin:0 0 12px 0; font-size:24px; font-weight:700 }
#timer{ font-size:52px; font-weight:800; color:var(--accent); margin:16px 0; letter-spacing:-1px; }
.timer-controls{ display:flex; gap:12px; justify-content:center; margin-bottom:16px; flex-wrap:wrap; }
.timer-controls button{ 
  padding:12px 20px; 
  border-radius:12px; 
  border:0; 
  cursor:pointer; 
  background:var(--accent); 
  color:#042726; 
  font-weight:700; 
  font-size:15px;
  transition:all 0.15s ease;
  min-width: 90px;
}
.timer-controls button[disabled]{ opacity:0.6; cursor:not-allowed; transform:none }
.timer-controls button:not([disabled]):hover{ 
  transform:translateY(-2px) scale(1.02); 
  box-shadow:0 12px 28px rgba(78,205,196,0.5); 
}
.settings{ display:flex; gap:16px; justify-content:center; align-items:center; margin-top:12px; flex-wrap:wrap; }
.settings label{ display:flex; flex-direction:column; align-items:center; gap:6px; font-size:14px; }
.settings input{ width:80px; padding:12px; border-radius:10px; border:0; background:rgba(255,255,255,0.08); color:var(--text); text-align:center; font-size:16px; font-weight:600; }
.progress-row{ display:flex; justify-content:space-between; gap:16px; margin-top:16px; align-items:center; font-size:14px; color:var(--muted); width:100%; flex-wrap:wrap; }

/* TODO - Bottom Right */
.todo-container{
  grid-area: todo;
  background:var(--glass);
  backdrop-filter: blur(16px);
  border-radius:var(--radius);
  box-shadow:0 20px 50px var(--shadow);
  border: 1px solid rgba(78,205,196,0.15);
  padding:24px;
  transition: all 0.2s ease-out;
  display: flex;
  flex-direction: column;
  height: 100%;
}
.todo-container:hover{
  transform:translateY(-4px);
  box-shadow:0 32px 70px rgba(78,205,196,0.3);
}
.todo-container h2{ margin:0 0 16px 0; font-size:22px; text-align:center; }
.todo-input{ display:flex; gap:12px; margin-bottom:20px; flex-direction:column; }
.todo-input input{ padding:14px 16px; border-radius:12px; border:0; background:rgba(255,255,255,0.08); color:var(--text); font-size:15px; }
.todo-input button{ padding:14px 20px; border-radius:12px; border:0; background:var(--accent); color:#042726; font-weight:700; font-size:15px; transition:all 0.15s ease; }
.todo-input button:hover{ transform:translateY(-2px); box-shadow:0 12px 28px rgba(78,205,196,0.5); }
ul#todo-list{ flex:1; list-style:none; padding:0; margin:0; overflow-y:auto; }
li.quest{ 
  display:flex; justify-content:space-between; align-items:center; gap:16px; 
  padding:14px 16px; margin-bottom:12px; border-radius:12px; 
  background:linear-gradient(135deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); 
  border:1px solid rgba(255,255,255,0.08); 
  transition:all 0.15s ease;
}
li.quest:hover{ transform:translateX(4px); box-shadow:0 8px 24px rgba(78,205,196,0.2); }
.quest .left{ display:flex; gap:12px; align-items:center; flex:1; }
.checkbox{ width:32px; height:32px; border-radius:10px; border:2px solid rgba(255,255,255,0.15); display:flex; align-items:center; justify-content:center; cursor:pointer; background:rgba(255,255,255,0.03); transition:all 0.15s ease; flex-shrink:0; }
.checkbox:hover{ transform:scale(1.05); box-shadow:0 0 12px rgba(78,205,196,0.4); }
.checkbox.done{ background:var(--success); border-color:var(--success); color:#042726; }
.quest .desc{ font-weight:700; font-size:15px; flex:1; }
.quest .meta{ font-size:13px; color:var(--muted); flex-shrink:0; white-space:nowrap; }
.quest button.del{ padding:8px 12px; border-radius:10px; border:0; background:var(--danger); color:#fff; cursor:pointer; font-weight:600; transition:all 0.15s ease; }
.quest button.del:hover{ transform:translateY(-1px); box-shadow:0 8px 20px rgba(255,90,90,0.5); background:#ff7272; }
.quest.done .desc{ text-decoration:line-through; opacity:0.6; color:#bfeee5 }
.quest.done .meta{ opacity:0.7 }

/* Sidebar specific styles */
#datetime-box{ font-size:16px; letter-spacing:0.3px; text-align:center; margin-bottom:12px; }
.stats-row{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
.stat-pill{ background:rgba(255,255,255,0.08); padding:8px 14px; border-radius:12px; font-size:14px; border:1px solid rgba(78,205,196,0.2); }
.quotes h3, .journal-box h4{ margin:0 0 12px 0; font-size:16px; }
.quote-text{ font-size:15px; min-height:48px; margin-bottom:12px; }
.quote-actions{ display:flex; gap:10px; flex-wrap:wrap; }
.small-btn{ border:0; padding:10px 16px; border-radius:12px; cursor:pointer; background:var(--accent); color:#042726; font-weight:700; font-size:14px; transition:all 0.15s ease; flex:1; min-width:100px; }
.small-btn:hover{ transform:translateY(-1px); box-shadow:0 8px 20px rgba(78,205,196,0.4); }
.journal-box{ margin-top:16px; flex:1; }
#endDayJournal{ width:100%; resize:vertical; border-radius:12px; padding:12px; font-size:14px; background:rgba(255,255,255,0.06); color:var(--text); border:1px solid rgba(78,205,196,0.25); min-height:100px; }
#endDayJournal:focus{ outline:none; box-shadow:0 0 12px rgba(78,205,196,0.5); }
#endDayBtn{ margin-top:auto; padding:14px; border-radius:12px; border:0; cursor:pointer; background:linear-gradient(135deg, #4ecdc4, #6ef0c9); color:#042726; font-weight:800; font-size:16px; box-shadow:0 12px 32px rgba(78,205,196,0.5); display:flex; align-items:center; justify-content:center; gap:10px; transition:all 0.2s ease; }
#endDayBtn:hover{ transform:translateY(-2px) scale(1.02); box-shadow:0 20px 40px rgba(78,205,196,0.6); }

/* RESPONSIVE - Mobile/Tablet */
@media (max-width: 880px) {
  .dashboard-grid {
    grid-template-columns: 1fr;
    grid-template-rows: auto 1fr auto auto;
    grid-template-areas: 
      "header"
      "timer"
      "sidebar"
      "todo";
    padding: 12px;
    gap: 12px;
  }
  .brand-title { font-size: 24px; }
  #timer { font-size: 42px; }
  .logo { width: 40px; height: 40px; }
}

@media (max-width: 480px) {
  .dashboard-grid { padding: 8px; gap: 10px; }
  .header { padding: 16px 20px; flex-direction: column; text-align: center; gap: 12px; }
  .brand-title { font-size: 20px; }
  #timer { font-size: 36px; }
  .timer-controls button { padding: 10px 16px; font-size: 14px; }
}

/* End Day Overlay */
#endDayOverlay{
  position:fixed; inset:0; background:rgba(3,6,18,0.95); backdrop-filter:blur(20px);
  display:flex; align-items:center; justify-content:center; z-index:50;
  opacity:0; pointer-events:none; transition:opacity 0.35s ease; padding:20px;
}
#endDayOverlay.active{ opacity:1; pointer-events:auto; }
.end-day-content{
  text-align:center; width:100%; max-width:420px; padding:32px 24px;
  border-radius:20px; background:rgba(8,10,20,0.98); box-shadow:0 30px 80px rgba(0,0,0,0.9);
  border:1px solid rgba(78,205,196,0.4);
}
.end-day-circle{ width:100px; height:100px; border-radius:50%; margin:0 auto 24px;
  background:radial-gradient(circle at 30% 20%, #ffffff, #4ecdc4); position:relative; overflow:hidden;
  animation:endCircle 1.6s ease-out forwards;
}
.end-day-check{ position:absolute; top:50%; left:50%; transform:translate(-50%,-50%) scale(0.2); opacity:0;
  font-size:42px; color:#042726; font-weight:800; animation:endCheck 1.4s 0.4s ease-out forwards;
}
@keyframes endCircle{ 0%{transform:scale(0.4);opacity:0;} 60%{transform:scale(1.05);opacity:1;} 100%{transform:scale(1);opacity:1;} }
@keyframes endCheck{ 0%{opacity:0;transform:translate(-50%,-50%) scale(0.2);} 40%{opacity:1;transform:translate(-50%,-50%) scale(1.1);} 100%{opacity:1;transform:translate(-50%,-50%) scale(1);} }
.end-day-title{ font-size:26px; margin-bottom:8px; font-weight:800; }
.end-day-sub{ font-size:15px; color:var(--muted); margin-bottom:20px; }
#endDaySummary{ font-family:"Poppins", monospace; font-size:17px; min-height:64px; white-space:pre-line; margin-bottom:20px; }
.end-day-hint{ font-size:13px; color:var(--muted); }

/* Hide number input spinners */
input[type=number]::-webkit-outer-spin-button, input[type=number]::-webkit-inner-spin-button { -webkit-appearance:none; margin:0; }
input[type=number] { -moz-appearance:textfield; }
</style>
</head>
<body>
<div class="overlay"></div>

<div class="dashboard-grid">
  <!-- HEADER: Logo + GrindForge Title -->
  <header class="header">
    <img src="/GrindForge.png" alt="GrindForge Logo" class="logo">
    <div>
      <h1 class="brand-title">GrindForge</h1>
      <p class="brand-subtitle">Pomodoro Productivity Dashboard</p>
    </div>
  </header>

  <!-- SIDEBAR: Date, Stats, Quotes, Journal -->
  <aside class="sidebar">
    <div class="box" id="dateBox">
      <div id="datetime-box" aria-live="polite">Loading date...</div>
      <div class="stats-row">
        <div class="stat-pill" id="hoursCompleted">Hours: 0.00</div>
        <div class="stat-pill" id="sessionsCompleted">Sessions: 0</div>
      </div>
    </div>

    <div class="box quotes">
      <h3>Quote</h3>
      <div class="quote-text" id="quoteText">"Stay focused - distractions are the enemy of progress."</div>
      <div class="quote-actions">
        <button class="small-btn" id="newQuoteBtn">New Quote</button>
        <button class="small-btn" id="saveQuoteBtn" style="background:#2b3dff;color:white">Save</button>
      </div>
      <div style="margin-top:8px; font-size:13px; color:var(--muted)">Saved quotes persist locally.</div>

      <div class="journal-box">
        <h4>Daily Journal</h4>
        <textarea id="endDayJournal" placeholder="Write your thoughts about today..." rows="4"></textarea>
        <button id="saveJournalBtn" class="small-btn" style="margin-top:12px;">Save Journal</button>
      </div>

      <button id="endDayBtn">
        <span style="font-size:20px;">ðŸŒ™</span>
        <span>End Day</span>
      </button>
    </div>
  </aside>

  <!-- TIMER: Top Right -->
  <section class="timer-box" aria-label="Pomodoro Timer">
    <h1>Pomodoro Timer</h1>
    <div id="timer" aria-live="polite">25:00</div>
    <div class="timer-controls">
      <button id="startBtn">Start</button>
      <button id="pauseBtn" disabled>Pause</button>
      <button id="resetBtn">Reset</button>
    </div>
    <div class="settings">
      <label>Work
        <input id="workTime" type="number" min="1" value="25" />
      </label>
      <label>Break
        <input id="breakTime" type="number" min="1" value="5" />
      </label>
    </div>
    <div class="progress-row">
      <div id="modeLabel">Mode: Work</div>
      <div id="sessionLabel">Completed: 0</div>
    </div>
  </section>

  <!-- TODO: Bottom Right -->
  <aside class="todo-container" aria-label="To-Do">
    <h2>To-Do List âœ¨</h2>
    <div class="todo-input">
      <input id="todoInput" type="text" placeholder="Write a task..." />
      <button id="addTaskBtn">Add Task</button>
    </div>
    <ul id="todo-list" aria-live="polite"></ul>
  </aside>
</div>

<audio id="alarm" preload="auto"></audio>

<div id="endDayOverlay">
  <div class="end-day-content">
    <div class="end-day-circle">
      <div class="end-day-check">âœ“</div>
    </div>
    <div class="end-day-title">Day Complete</div>
    <div class="end-day-sub">Here is what you achieved today:</div>
    <div id="endDaySummary"></div>
    <div class="end-day-hint">Press Esc or click anywhere to close.</div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // All existing JavaScript remains exactly the same...
  const alarm = document.getElementById('alarm');
  const startBtn = document.getElementById('startBtn');
  const pauseBtn = document.getElementById('pauseBtn');
  const resetBtn = document.getElementById('resetBtn');
  const timerEl = document.getElementById('timer');
  const workInput = document.getElementById('workTime');
  const breakInput = document.getElementById('breakTime');
  const modeLabel = document.getElementById('modeLabel');
  const sessionLabel = document.getElementById('sessionLabel');
  const newQuoteBtn = document.getElementById('newQuoteBtn');
  const saveQuoteBtn = document.getElementById('saveQuoteBtn');
  const quoteTextEl = document.getElementById('quoteText');
  const todoInput = document.getElementById('todoInput');
  const addTaskBtn = document.getElementById('addTaskBtn');
  const todoList = document.getElementById('todo-list');
  const hoursCompletedPill = document.getElementById('hoursCompleted');
  const sessionsCompletedPill = document.getElementById('sessionsCompleted');
  const datetimeBox = document.getElementById('datetime-box');
  const endDayBtn = document.getElementById('endDayBtn');
  const endDayOverlay = document.getElementById('endDayOverlay');
  const endDaySummary = document.getElementById('endDaySummary');
  const endDayJournal = document.getElementById('endDayJournal');
  const saveJournalBtn = document.getElementById('saveJournalBtn');

  const S_TASKS = 'gf_tasks_v2';
  const S_STATS = 'gf_stats_v2';
  const S_QUOTES = 'gf_quotes_v1';
  const S_JOURNAL = 'gf_journal_v1';
  
  alarm.src = 'https://cdn.pixabay.com/audio/2022/03/15/audio_0b1aefdd20.mp3';
  alarm.volume = 0.7;

  let audioUnlocked = false;
  let timerInterval = null;
  let isRunning = false;
  let isWork = true;
  let timeLeft = 25 * 60;
  let stats = { completedSeconds: 0, sessionsCompleted: 0, lastDate: '' };

  function getTodayStr() {
    const d = new Date();
    return d.getFullYear() + '-' + String(d.getMonth()+1).padStart(2,'0') + '-' + String(d.getDate()).padStart(2,'0');
  }
  function safeParseInt(v, fallback) {
    const n = parseInt(v, 10);
    return Number.isFinite(n) ? n : fallback;
  }

  function unlockAudio() {
    if (audioUnlocked) return;
    alarm.play().then(() => {
      alarm.pause();
      alarm.currentTime = 0;
      audioUnlocked = true;
    }).catch(() => {});
  }

  function updateDateTime() {
    const now = new Date();
    const dateOpt = { weekday:'long', month:'long', day:'numeric' };
    const dateText = now.toLocaleDateString(undefined, dateOpt);
    const timeText = now.toLocaleTimeString(undefined, { hour:'2-digit', minute:'2-digit' });
    datetimeBox.textContent = `${dateText} â€¢ ${timeText}`;
  }
  setInterval(updateDateTime, 1000);
  updateDateTime();

  const defaultQuotes = [
    "Focus is a skill - practice it daily.",
    "You don't have to be perfect, just persistent.",
    "Small progress each day adds up to big results.",
    "Work in silence, let success make the noise.",
    "One task at a time. Win the moment."
  ];
  
  let quotes = defaultQuotes.slice();
  function showRandomQuote() {
    const q = quotes[Math.floor(Math.random() * quotes.length)];
    quoteTextEl.textContent = `"${q}"`;
  }
  newQuoteBtn.addEventListener('click', showRandomQuote);
  saveQuoteBtn.addEventListener('click', function() {
    const q = prompt('Add a new quote:');
    if (q && q.trim()) {
      quotes.unshift(q.trim());
      localStorage.setItem(S_QUOTES, JSON.stringify(quotes));
      showRandomQuote();
    }
  });
  showRandomQuote();

  function updateStatsUI() {
    const totalSec = stats.completedSeconds || 0;
    const decimal = (totalSec / 3600).toFixed(2);
    hoursCompletedPill.textContent = `Hours: ${decimal}`;
    sessionsCompletedPill.textContent = `Sessions: ${stats.sessionsCompleted || 0}`;
    sessionLabel.textContent = `Completed: ${stats.sessionsCompleted || 0}`;
  }
  function loadStats() {
    try {
      const raw = localStorage.getItem(S_STATS);
      if (raw) {
        const parsed = JSON.parse(raw);
        if (parsed.lastDate === getTodayStr()) {
          stats = parsed;
        }
      }
    } catch(e) {}
    updateStatsUI();
  }
  loadStats();

  function renderTime() {
    const m = Math.floor(timeLeft / 60);
    const s = timeLeft % 60;
    timerEl.textContent = String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0');
  }
  function setModeLabel() {
    modeLabel.textContent = `Mode: ${isWork ? 'Work' : 'Break'}`;
  }
  function playAlarm() {
    unlockAudio();
    alarm.currentTime = 0;
    alarm.play().catch(() => {});
  }

  function tick() {
    if (timeLeft > 0) {
      timeLeft--;
      renderTime();
    }
    if (timeLeft <= 0) {
      if (isWork) {
        const workMin = safeParseInt(workInput.value, 25);
        stats.completedSeconds += workMin * 60;
        stats.sessionsCompleted++;
        stats.lastDate = getTodayStr();
        localStorage.setItem(S_STATS, JSON.stringify(stats));
        updateStatsUI();
      }
      playAlarm();
      isWork = !isWork;
      setModeLabel();
      timeLeft = isWork ? safeParseInt(workInput.value, 25) * 60 : safeParseInt(breakInput.value, 5) * 60;
      renderTime();
    }
  }

  function updateControls() {
    startBtn.disabled = isRunning;
    pauseBtn.disabled = !isRunning;
  }

  function startTimer() {
    unlockAudio();
    if (isRunning) return;
    isRunning = true;
    updateControls();
    renderTime();
    timerInterval = setInterval(tick, 1000);
  }
  function pauseTimer() {
    if (timerInterval) {
      clearInterval(timerInterval);
      timerInterval = null;
    }
    isRunning = false;
    updateControls();
  }
  function resetTimer() {
    pauseTimer();
    isWork = true;
    timeLeft = safeParseInt(workInput.value, 25) * 60;
    setModeLabel();
    renderTime();
  }

  startBtn.addEventListener('click', startTimer);
  pauseBtn.addEventListener('click', pauseTimer);
  resetBtn.addEventListener('click', resetTimer);

  workInput.addEventListener('change', function() {
    if (!isRunning && isWork) {
      timeLeft = safeParseInt(workInput.value, 25) * 60;
      renderTime();
    }
  });
  breakInput.addEventListener('change', function() {
    if (!isRunning && !isWork) {
      timeLeft = safeParseInt(breakInput.value, 5) * 60;
      renderTime();
    }
  });

  renderTime();
  setModeLabel();
  updateControls();

  function loadTasks() {
    try {
      const raw = localStorage.getItem(S_TASKS);
      return raw ? JSON.parse(raw) : [];
    } catch(e) { return []; }
  }
  function saveTasks(items) {
    try { localStorage.setItem(S_TASKS, JSON.stringify(items)); } catch(e) {}
  }
  function refreshTasksUI() {
    const items = loadTasks();
    todoList.innerHTML = '';
    const undone = items.filter(it => !it.done);
    const done = items.filter(it => it.done);
    [...undone, ...done].forEach(item => {
      const li = document.createElement('li');
      li.className = `quest ${item.done ? 'done' : ''}`;
      const left = document.createElement('div');
      left.className = 'left';
      const checkbox = document.createElement('div');
      checkbox.className = `checkbox ${item.done ? 'done' : ''}`;
      checkbox.innerHTML = item.done ? 'âœ“' : '';
      checkbox.addEventListener('click', () => {
        item.done = !item.done;
        saveTasks(loadTasks().map(x => x.id === item.id ? item : x));
        refreshTasksUI();
      });
      const desc = document.createElement('span');
      desc.className = 'desc';
      desc.textContent = item.text;
      const meta = document.createElement('span');
      meta.className = 'meta';
      meta.textContent = item.done ? 'Completed' : 'Quest';
      left.appendChild(checkbox);
      left.appendChild(desc);
      left.appendChild(meta);
      const delBtn = document.createElement('button');
      delBtn.className = 'del';
      delBtn.textContent = 'âœ•';
      delBtn.addEventListener('click', () => {
        saveTasks(loadTasks().filter(x => x.id !== item.id));
        refreshTasksUI();
      });
      li.appendChild(left);
      li.appendChild(delBtn);
      todoList.appendChild(li);
    });
  }
  function addTask() {
    const text = todoInput.value.trim();
    if (!text) return;
    const tasks = loadTasks();
    const newTask = { id: Date.now().toString(36), text, done: false, createdAt: Date.now() };
    tasks.push(newTask);
    saveTasks(tasks);
    todoInput.value = '';
    refreshTasksUI();
  }
  addTaskBtn.addEventListener('click', addTask);
  todoInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') addTask();
  });
  refreshTasksUI();

  function loadJournal() {
    try {
      const saved = localStorage.getItem(S_JOURNAL);
      endDayJournal.value = saved || '';
    } catch(e) { endDayJournal.value = ''; }
  }
  function saveJournal() {
    try {
      localStorage.setItem(S_JOURNAL, endDayJournal.value.trim());
      saveJournalBtn.textContent = 'Saved âœ”';
      setTimeout(() => saveJournalBtn.textContent = 'Save Journal', 1200);
    } catch(e) { alert('Failed to save journal.'); }
  }
  saveJournalBtn.addEventListener('click', function(e){ e.stopPropagation(); saveJournal(); });
  loadJournal();

  function typeWriterText(text, element, speed) {
    element.textContent = '';
    let i = 0;
    const interval = setInterval(() => {
      element.textContent += text.charAt(i);
      i++;
      if(i >= text.length) clearInterval(interval);
    }, speed);
  }

  function openEndDayOverlay() {
    loadStats();
    const hours = (stats.completedSeconds / 3600).toFixed(2);
    const sessions = stats.sessionsCompleted || 0;
    const summaryText = `Today you completed ${sessions} session${sessions === 1 ? '' : 's'}\nand studied ${hours} hour${hours === '1.00' ? '' : 's'}.`;
    saveJournal();
    endDayOverlay.classList.add('active');
    typeWriterText(summaryText, endDaySummary, 50);
  }

  function closeEndDayOverlay() {
    endDayOverlay.classList.remove('active');
  }

  endDayBtn.addEventListener('click', openEndDayOverlay);
  endDayOverlay.addEventListener('click', closeEndDayOverlay);
  document.addEventListener('keydown', function(e) {
    if(e.key === 'Escape') closeEndDayOverlay();
  });

  console.log('ðŸš€ GrindForge Dashboard - Excel-style Grid Layout Loaded!');
});
</script>
</body>
</html>
